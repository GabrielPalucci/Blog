{
  "hash": "9706ee74c010a30915881d25aef39e71",
  "result": {
    "engine": "knitr",
    "markdown": "---\nimage: ppa.png\npage-layout: article\ntitle-block-banner: pp.png\ndate: \"2023-12-22\"\ntitle: \"Utilizando Dplyr e ggplot2 | palmerpenguins\"\nauthor: \"Gabriel Palucci Rosa\"\ntoc: true\ntoc-title: \"Table of Content\"\ncategories:\n  - Penguins\n  - Dplyr\n  - ggplot2\n---\n\n\n# Introdução\n\nAo analisarmos bases de dados com muitas colunas e linhas, torna-se essencial dominar ferramentas que facilitem o **manejo**, a **organização** e a **transformação** dos dados. Operações como selecionar variáveis específicas, filtrar observações ou criar novas colunas fazem parte da rotina de qualquer análise.\n\n::: callout-note\n## Características do pacote dplyr\n\n-   **Rename:** Renomear coluna\n-   **Slice:** Selecionar linhas\n-   **Select:** Comparação sistemática de algoritmos\n-   **Filter:** Análise de diferentes propriedades do solo\n-   **Relocate:** Modificar a coluna \n-   **Arrange:** Organizar os dados de forma sequêncial\n-   **Summarise:** Realizar métricas com os dados\n-   **pivot longer:** Manipulação dos dados\n:::\n\n\nAlgumas pessoas recorrem a softwares ou linguagens voltadas exclusivamente para bancos de dados (como SQL). No entanto, o **R** se destaca por permitir que toda a etapa de manipulação esteja integrada à análise estatística e à visualização de dados.\n\nNeste post, apresento um guia **didático e progressivo** sobre a manipulação de dados com o pacote **dplyr**, parte do ecossistema **tidyverse**.\n\n------------------------------------------------------------------------\n\n## Instalação e carregamento dos pacotes\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(pacman)\np_load(tidyverse, magrittr, palmerpenguins, ggthemes)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npinguim <- dplyr::as_tibble(palmerpenguins::penguins)\n```\n:::\n\n\n------------------------------------------------------------------------\n\n## Renomeando colunas com `rename()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\npinguim <- pinguim %>% \n  rename(\n    Especies = species, \n    Ilha = island,\n    Tamanho_Bico_mm = bill_length_mm,\n    Espessura_Bico_mm = bill_depth_mm,\n    Nadadeira_mm = flipper_length_mm,\n    Peso_g = body_mass_g,\n    Sexo = sex,\n    Ano = year\n  )\n```\n:::\n\n\n------------------------------------------------------------------------\n\n## Selecionando linhas com `slice()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\npinguim %>% \n  slice(1:20)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 20 × 8\n   Especies Ilha     Tamanho_Bico_mm Espessura_Bico_mm Nadadeira_mm Peso_g Sexo \n   <fct>    <fct>              <dbl>             <dbl>        <int>  <int> <fct>\n 1 Adelie   Torgers…            39.1              18.7          181   3750 male \n 2 Adelie   Torgers…            39.5              17.4          186   3800 fema…\n 3 Adelie   Torgers…            40.3              18            195   3250 fema…\n 4 Adelie   Torgers…            NA                NA             NA     NA <NA> \n 5 Adelie   Torgers…            36.7              19.3          193   3450 fema…\n 6 Adelie   Torgers…            39.3              20.6          190   3650 male \n 7 Adelie   Torgers…            38.9              17.8          181   3625 fema…\n 8 Adelie   Torgers…            39.2              19.6          195   4675 male \n 9 Adelie   Torgers…            34.1              18.1          193   3475 <NA> \n10 Adelie   Torgers…            42                20.2          190   4250 <NA> \n11 Adelie   Torgers…            37.8              17.1          186   3300 <NA> \n12 Adelie   Torgers…            37.8              17.3          180   3700 <NA> \n13 Adelie   Torgers…            41.1              17.6          182   3200 fema…\n14 Adelie   Torgers…            38.6              21.2          191   3800 male \n15 Adelie   Torgers…            34.6              21.1          198   4400 male \n16 Adelie   Torgers…            36.6              17.8          185   3700 fema…\n17 Adelie   Torgers…            38.7              19            195   3450 fema…\n18 Adelie   Torgers…            42.5              20.7          197   4500 male \n19 Adelie   Torgers…            34.4              18.4          184   3325 fema…\n20 Adelie   Torgers…            46                21.5          194   4200 male \n# ℹ 1 more variable: Ano <int>\n```\n\n\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n## Selecionando colunas com `select()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\npinguim %>% \n  select(Especies, Ilha, Peso_g)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 344 × 3\n   Especies Ilha      Peso_g\n   <fct>    <fct>      <int>\n 1 Adelie   Torgersen   3750\n 2 Adelie   Torgersen   3800\n 3 Adelie   Torgersen   3250\n 4 Adelie   Torgersen     NA\n 5 Adelie   Torgersen   3450\n 6 Adelie   Torgersen   3650\n 7 Adelie   Torgersen   3625\n 8 Adelie   Torgersen   4675\n 9 Adelie   Torgersen   3475\n10 Adelie   Torgersen   4250\n# ℹ 334 more rows\n```\n\n\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n## Criando variáveis com `mutate()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\npinguim %>% \n  mutate(Relacao_Bico = Tamanho_Bico_mm / Espessura_Bico_mm) %>%\n  select(Especies, Ilha, Relacao_Bico)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 344 × 3\n   Especies Ilha      Relacao_Bico\n   <fct>    <fct>            <dbl>\n 1 Adelie   Torgersen         2.09\n 2 Adelie   Torgersen         2.27\n 3 Adelie   Torgersen         2.24\n 4 Adelie   Torgersen        NA   \n 5 Adelie   Torgersen         1.90\n 6 Adelie   Torgersen         1.91\n 7 Adelie   Torgersen         2.19\n 8 Adelie   Torgersen         2   \n 9 Adelie   Torgersen         1.88\n10 Adelie   Torgersen         2.08\n# ℹ 334 more rows\n```\n\n\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n## Filtrando dados com `filter()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\npinguim %>% \n  filter(Peso_g > 1000, Espessura_Bico_mm > 10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 342 × 8\n   Especies Ilha     Tamanho_Bico_mm Espessura_Bico_mm Nadadeira_mm Peso_g Sexo \n   <fct>    <fct>              <dbl>             <dbl>        <int>  <int> <fct>\n 1 Adelie   Torgers…            39.1              18.7          181   3750 male \n 2 Adelie   Torgers…            39.5              17.4          186   3800 fema…\n 3 Adelie   Torgers…            40.3              18            195   3250 fema…\n 4 Adelie   Torgers…            36.7              19.3          193   3450 fema…\n 5 Adelie   Torgers…            39.3              20.6          190   3650 male \n 6 Adelie   Torgers…            38.9              17.8          181   3625 fema…\n 7 Adelie   Torgers…            39.2              19.6          195   4675 male \n 8 Adelie   Torgers…            34.1              18.1          193   3475 <NA> \n 9 Adelie   Torgers…            42                20.2          190   4250 <NA> \n10 Adelie   Torgers…            37.8              17.1          186   3300 <NA> \n# ℹ 332 more rows\n# ℹ 1 more variable: Ano <int>\n```\n\n\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n## Reorganizando colunas com `relocate()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\npinguim %>% \n  relocate(Ilha, Sexo, Especies)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 344 × 8\n   Ilha     Sexo  Especies Tamanho_Bico_mm Espessura_Bico_mm Nadadeira_mm Peso_g\n   <fct>    <fct> <fct>              <dbl>             <dbl>        <int>  <int>\n 1 Torgers… male  Adelie              39.1              18.7          181   3750\n 2 Torgers… fema… Adelie              39.5              17.4          186   3800\n 3 Torgers… fema… Adelie              40.3              18            195   3250\n 4 Torgers… <NA>  Adelie              NA                NA             NA     NA\n 5 Torgers… fema… Adelie              36.7              19.3          193   3450\n 6 Torgers… male  Adelie              39.3              20.6          190   3650\n 7 Torgers… fema… Adelie              38.9              17.8          181   3625\n 8 Torgers… male  Adelie              39.2              19.6          195   4675\n 9 Torgers… <NA>  Adelie              34.1              18.1          193   3475\n10 Torgers… <NA>  Adelie              42                20.2          190   4250\n# ℹ 334 more rows\n# ℹ 1 more variable: Ano <int>\n```\n\n\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n## Ordenando dados com `arrange()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\npinguim %>% \n  select(Especies, Ilha, Peso_g) %>% \n  arrange(desc(Peso_g))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 344 × 3\n   Especies Ilha   Peso_g\n   <fct>    <fct>   <int>\n 1 Gentoo   Biscoe   6300\n 2 Gentoo   Biscoe   6050\n 3 Gentoo   Biscoe   6000\n 4 Gentoo   Biscoe   6000\n 5 Gentoo   Biscoe   5950\n 6 Gentoo   Biscoe   5950\n 7 Gentoo   Biscoe   5850\n 8 Gentoo   Biscoe   5850\n 9 Gentoo   Biscoe   5850\n10 Gentoo   Biscoe   5800\n# ℹ 334 more rows\n```\n\n\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n## Agregando dados com `group_by()` e `summarise()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\npinguim %>% \n  group_by(Ilha, Especies) %>%\n  summarise(\n    Peso_Maximo = max(Peso_g, na.rm = TRUE),\n    Media_Nadadeira = mean(Nadadeira_mm, na.rm = TRUE),\n    .groups = \"drop\"\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 4\n  Ilha      Especies  Peso_Maximo Media_Nadadeira\n  <fct>     <fct>           <int>           <dbl>\n1 Biscoe    Adelie           4775            189.\n2 Biscoe    Gentoo           6300            217.\n3 Dream     Adelie           4650            190.\n4 Dream     Chinstrap        4800            196.\n5 Torgersen Adelie           4700            191.\n```\n\n\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n## Reestruturando dados com `pivot_longer()`\n\n\n::: {.cell}\n\n```{.r .cell-code}\npinguim_long <- pinguim %>% \n  select(Especies, Sexo, Tamanho_Bico_mm, Espessura_Bico_mm, Nadadeira_mm) %>%\n  pivot_longer(\n    cols = c(Tamanho_Bico_mm, Espessura_Bico_mm, Nadadeira_mm),\n    names_to = \"Variavel\",\n    values_to = \"Valor\"\n  )\n\npinguim_long\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1,032 × 4\n   Especies Sexo   Variavel          Valor\n   <fct>    <fct>  <chr>             <dbl>\n 1 Adelie   male   Tamanho_Bico_mm    39.1\n 2 Adelie   male   Espessura_Bico_mm  18.7\n 3 Adelie   male   Nadadeira_mm      181  \n 4 Adelie   female Tamanho_Bico_mm    39.5\n 5 Adelie   female Espessura_Bico_mm  17.4\n 6 Adelie   female Nadadeira_mm      186  \n 7 Adelie   female Tamanho_Bico_mm    40.3\n 8 Adelie   female Espessura_Bico_mm  18  \n 9 Adelie   female Nadadeira_mm      195  \n10 Adelie   <NA>   Tamanho_Bico_mm    NA  \n# ℹ 1,022 more rows\n```\n\n\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n## Exemplo integrado\n\n\n::: {.cell}\n\n```{.r .cell-code}\npinguim %>% \n  select(Especies, Ilha, Peso_g) %>% \n  arrange(desc(Peso_g)) %>% \n  slice(1:10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 10 × 3\n   Especies Ilha   Peso_g\n   <fct>    <fct>   <int>\n 1 Gentoo   Biscoe   6300\n 2 Gentoo   Biscoe   6050\n 3 Gentoo   Biscoe   6000\n 4 Gentoo   Biscoe   6000\n 5 Gentoo   Biscoe   5950\n 6 Gentoo   Biscoe   5950\n 7 Gentoo   Biscoe   5850\n 8 Gentoo   Biscoe   5850\n 9 Gentoo   Biscoe   5850\n10 Gentoo   Biscoe   5800\n```\n\n\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n## Visualização dos dados\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = na.omit(pinguim), aes(x = Tamanho_Bico_mm, y = Espessura_Bico_mm)) +\n  geom_point(aes(color = Especies, size = Peso_g), alpha = 0.7) +\n  facet_wrap(~Sexo) +\n  labs(\n    x = \"Tamanho do bico (mm)\", \n    y = \"Espessura do bico (mm)\",\n    color = \"Espécie\", \n    size = \"Peso (g)\"\n  ) +\n  theme_light() +\n  theme_wsj()\n```\n\n::: {.cell-output-display}\n![](tidyverse_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n## Referências\n\n-   Wickham et al. (2019). *Welcome to the tidyverse*. JOSS.\n-   Horst et al. (2020). *palmerpenguins*.\n\n![](https://www.tidyverse.org/images/hex-tidyverse.png){width=\"15%\"} ![](https://magrittr.tidyverse.org/logo.png){width=\"15%\"} ![](https://allisonhorst.github.io/palmerpenguins/reference/figures/logo.png){width=\"15%\"}\n",
    "supporting": [
      "tidyverse_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}