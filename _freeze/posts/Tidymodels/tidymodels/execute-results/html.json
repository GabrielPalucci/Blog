{
  "hash": "3cf85ad06e22bbfb42b78dd6aa06ca2e",
  "result": {
    "engine": "knitr",
    "markdown": "---\npage-layout: article\ndate: \"2023-12-22\"\ntitle: \"Utilizando tidymodels | palmerpenguins\"\nauthor: \"Gabriel Palucci Rosa\"\ntoc: true\ntoc-title: \"Table of Content\"\ncategories:\n  - Penguins\n  - Dplyr\n  - ggplot2\n---\n\n\n# Introdução\n\nCompreender o que os dados estão nos dizendo é de suma importancia para ciencia, para isso realizamos diveros processos de investigação inicial. Após essa etapa Ao analisarmos bases de dados com muitas colunas e linhas, torna-se essencial dominar ferramentas que facilitem o **manejo**,\n\nO tidymodels é composto por diversos pacotes sendo os principais\n\nrsample - Promove realizar processo random substs (Bootstrap) recipe - Contem funções de transformação de data para modelos (Feature enginnering)\n\nparsip - Pacote que cntem diversos modelos que serão utilizados Tune e dias - Fine-tuningn e melhorar o modelo\n\nyardstick package - provem metricas para entender o modelos\n\n-   Podemos ter mdelos\n\nRegressao - Modelos nmericos quatitativos classificação - categorial ( sim ou não)\n\n#Processo\n\ntreino e teste\n\nTreino - feature engineering Model fiting e tunning\n\nTeste\n\nPerforma em um data nunca visto\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidymodels)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npinguins <- palmerpenguins::penguins\npinguins <- pinguins %>%\n  filter(species == \"Adelie\") %>% \n  na.omit()\n\npinguin_splite<- initial_split(data = pinguins,\n              prop = 0.7,\n              strata = body_mass_g)\n\n\npinguin_train <- pinguin_splite %>% \n  training()\n\npinguin_test <- pinguin_splite %>% \n  testing()\n```\n:::\n\n\nVamos ver modelos simples, sendo assim iremos começar com modelos de regressão, para isso iremos analisar utilizaremos o pacote yardstick() para ajustar modelos e analisar a predição.\n\nComo exemplo iremos predizir o peso em g dos pinguins em relação a tamanho do bico\n\nformula basica\n\ny = b + ax\n\nO sistema de parsnip se estrutura em 3 etapas\n\n1 - Especificar o tipo de modelo\n\n2 - Especificar a engine\n\n3 - Especificar o modo\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlinear_model <- linear_reg() %>% \n  set_engine(engine = \"lm\") %>% \n  set_mode(mode = \"regression\")\n```\n:::\n\n\nApós criar nosso modelo, precisamos treinalo com nossos dados, sendo assim realizamos processo de fit.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm_fit <- linear_model %>%\n  fit(body_mass_g ~ bill_depth_mm,\n      data = pinguin_train)\n```\n:::\n\n\nApós criar o modelo, podemos investigar o resumo do modelo em sistema tibble.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(lm_fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 5\n  term          estimate std.error statistic      p.value\n  <chr>            <dbl>     <dbl>     <dbl>        <dbl>\n1 (Intercept)       75.6     599.      0.126 0.900       \n2 bill_depth_mm    197.       32.6     6.05  0.0000000270\n```\n\n\n:::\n:::\n\n\nA patir do modelo criado podemos\n\n\n::: {.cell}\n\n```{.r .cell-code}\npeso_pred <- lm_fit %>% \n  predict(new_data = pinguin_test)\n\npeso_pred\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 46 × 1\n   .pred\n   <dbl>\n 1 3510.\n 2 4142.\n 3 4241.\n 4 3589.\n 5 3708.\n 6 3688.\n 7 3767.\n 8 3866.\n 9 3471.\n10 3747.\n# ℹ 36 more rows\n```\n\n\n:::\n:::\n\n\nPara observar a avaliação podemos utilizar o bind_cols\n\n\n::: {.cell}\n\n```{.r .cell-code}\npeso_test_results <- pinguin_test %>% \n  select(body_mass_g,bill_depth_mm) %>% \n  bind_cols(peso_pred)\n\npeso_test_results\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 46 × 3\n   body_mass_g bill_depth_mm .pred\n         <int>         <dbl> <dbl>\n 1        3800          17.4 3510.\n 2        3650          20.6 4142.\n 3        4400          21.1 4241.\n 4        3700          17.8 3589.\n 5        3325          18.4 3708.\n 6        3400          18.3 3688.\n 7        3600          18.7 3767.\n 8        3800          19.2 3866.\n 9        3800          17.2 3471.\n10        3550          18.6 3747.\n# ℹ 36 more rows\n```\n\n\n:::\n:::\n\n\n##Evoluindo performece do modelos\n\nrmse\n\n\n::: {.cell}\n\n```{.r .cell-code}\npeso_test_results %>% \n  rmse(truth = body_mass_g, estimate = .pred)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 3\n  .metric .estimator .estimate\n  <chr>   <chr>          <dbl>\n1 rmse    standard        362.\n```\n\n\n:::\n\n```{.r .cell-code}\npeso_test_results %>% \n   rsq(truth = body_mass_g, estimate = .pred)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 3\n  .metric .estimator .estimate\n  <chr>   <chr>          <dbl>\n1 rsq     standard       0.468\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(peso_test_results, aes(x = body_mass_g,\n                              y = .pred))+\n  geom_point() +\n  geom_abline(color = \"red\", linetyper = 2)+\n  labs(x = \"Peso (g)\", y = \"Predict\") +\n  coord_obs_pred()+\n  theme_bw()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in geom_abline(color = \"red\", linetyper = 2): Ignoring unknown\nparameters: `linetyper`\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](tidymodels_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nFINal\n\nLast fit função\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm_last_fit <- linear_model %>% \n  last_fit(body_mass_g ~ bill_depth_mm,\n           split = pinguin_splite)\n\n\nlm_last_fit %>% collect_metrics()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 4\n  .metric .estimator .estimate .config        \n  <chr>   <chr>          <dbl> <chr>          \n1 rmse    standard     362.    pre0_mod0_post0\n2 rsq     standard       0.468 pre0_mod0_post0\n```\n\n\n:::\n\n```{.r .cell-code}\nlm_collect_predictions <- lm_last_fit %>% collect_predictions()\n```\n:::\n\n\n::: callout-note\n## Características do pacote dplyr\n\n-   **Rename:** Renomear coluna\n-   **Slice:** Selecionar linhas\n-   **Select:** Comparação sistemática de algoritmos\n-   **Filter:** Análise de diferentes propriedades do solo\n-   **Relocate:** Modificar a coluna\n-   **Arrange:** Organizar os dados de forma sequêncial\n-   **Summarise:** Realizar métricas com os dados\n-   **pivot longer:** Manipulação dos dados\n:::\n\n## Referências\n\n-   Wickham et al. (2019). *Welcome to the tidyverse*. JOSS.\n-   Horst et al. (2020). *palmerpenguins*.\n\n![](https://allisonhorst.github.io/palmerpenguins/reference/figures/logo.png){width=\"15%\"} ![](https://www.tidyverse.org/images/hex-tidyverse.png){width=\"15%\"} ![](https://magrittr.tidyverse.org/logo.png){width=\"15%\"} ![](https://tidymodels.tidymodels.org/logo.png){width=\"15%\"}\n",
    "supporting": [
      "tidymodels_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}